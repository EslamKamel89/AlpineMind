<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Form + Modal Project</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      .skeleton {
        position: relative;
        overflow: hidden;
        background: rgb(229 231 235);
      }
      .skeleton::after {
        content: "";
        position: absolute;
        inset: 0;
        transform: translateX(-100%);
        background: linear-gradient(
          90deg,
          rgba(229, 231, 235, 0) 0%,
          rgba(156, 163, 175, 0.25) 50%,
          rgba(229, 231, 235, 0) 100%
        );
        animation: shimmer 1.6s infinite;
      }
      @keyframes shimmer {
        100% {
          transform: translateX(100%);
        }
      }
      /* Hide elements meant to be initialized later (e.g., dialog) */
      .hidden-important {
        display: none !important;
      }
    </style>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    <style>
      [x-cloak] {
        display: none !important;
      }
    </style>
  </head>

  <body class="min-h-screen bg-gray-50 text-gray-900">
    <div id="header"></div>
    <div
      class="mx-auto max-w-7xl grid grid-cols-1 lg:grid-cols-[16rem,1fr] gap-6 px-4 sm:px-6 lg:px-8 mt-6"
    >
      <div id="aside"></div>
      <!-- A. PURE TEMPLATE (no Alpine, no JS) -->
      <section
        id="form-modal"
        class="scroll-mt-24"
        x-data="app()"
        x-id="['name','email','role','dialogTitle','dialogDesc']"
      >
        <h2 class="text-lg font-semibold mb-4">Form + Modal Project</h2>

        <!-- Open Modal Button (does nothing yet) -->
        <button
          class="px-4 py-2 bg-indigo-600 text-white rounded"
          @click="open()"
        >
          New Contact
        </button>

        <div
          class="fixed inset-0 z-50"
          x-show="isOpen"
          @keydown.window.escape="close()"
        >
          <!-- Backdrop -->
          <div class="absolute inset-0 bg-black/40" @click="close()"></div>

          <!-- Centered dialog -->
          <div class="absolute inset-0 flex items-center justify-center p-4">
            <div
              @click.outside="close()"
              class="w-full max-w-lg rounded-xl bg-white shadow border border-gray-200 p-4 outline-none"
              x-ref="dialog"
            >
              <div class="flex items-start justify-between">
                <h3 class="text-lg font-semibold">Add Contact</h3>
                <button class="px-3 py-1.5 rounded border" @click="close()">
                  ✕
                </button>
              </div>
              <p class="text-sm text-gray-600 mt-1">
                Fill out the information below, then save to add a new contact.
              </p>

              <!-- FORM (static) -->
              <form class="mt-4 space-y-4" @submit.prevent="submit()">
                <!-- Name -->
                <div>
                  <label
                    class="block text-sm font-medium mb-1"
                    :for="$id('name')"
                    >Full name</label
                  >
                  <input
                    :id="$id('name')"
                    x-ref="name"
                    x-model="form.name"
                    type="text"
                    class="w-full p-2 rounded-lg border-gray-300 focus:border-indigo-500 focus:ring-indigo-500"
                    placeholder="Jane Doe"
                  />
                </div>

                <!-- Email -->
                <div>
                  <label
                    class="block text-sm font-medium mb-1"
                    :for="$id('email')"
                    >Email</label
                  >
                  <input
                    :id="$id('email')"
                    x-model="form.email"
                    type="email"
                    class="w-full p-2 rounded-lg border-gray-300 focus:border-indigo-500 focus:ring-indigo-500"
                    placeholder="jane@example.com"
                  />
                </div>

                <!-- Role (radio) -->
                <fieldset>
                  <legend class="block text-sm font-medium mb-1">Role</legend>
                  <div class="flex items-center gap-6 text-sm">
                    <label
                      class="inline-flex items-center gap-2"
                      :for="$id('role')"
                    >
                      <input
                        :id="$id('role')"
                        x-model="form.role"
                        type="radio"
                        name="role"
                        value="admin"
                        class="text-indigo-600 border-gray-300"
                      />
                      <span>Admin</span>
                    </label>
                    <label class="inline-flex items-center gap-2">
                      <input
                        type="radio"
                        name="role"
                        value="user"
                        class="text-indigo-600 border-gray-300"
                        checked
                      />
                      <span>User</span>
                    </label>
                  </div>
                </fieldset>

                <!-- Actions -->
                <div class="flex justify-end gap-2 pt-2">
                  <button type="button" class="px-4 py-2 rounded-lg border">
                    Cancel
                  </button>
                  <button
                    type="submit"
                    class="px-4 py-2 rounded-lg bg-indigo-600 text-white"
                  >
                    Save
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <!-- Contacts (static preview) -->
        <div class="mt-6 bg-white border rounded-xl p-4">
          <h3 class="font-medium mb-2">Contacts</h3>
          <p x-show="contacts.length === 0" class="text-sm text-gray-500">
            No contacts yet.
          </p>
          <ul class="text-sm list-disc pl-5 space-y-1">
            <template x-for="c in contacts" :key="c.name + c.email">
              <li>
                <span class="font-medium" x-text="c.name"></span>
                (<span x-text="c.email"></span>) — <span x-text="c.role"></span>
              </li>
            </template>
          </ul>
        </div>
      </section>
    </div>
    <div id="footer"></div>
    <script>
      function app() {
        return {
          isOpen: false,
          form: {
            name: "",
            email: "",
            role: "user",
          },
          contacts: [],
          open() {
            this.isOpen = true;
            this.$nextTick(() => {
              this.$refs.name.focus();
              this.$refs.dialog.focus();
              document.documentElement.style.overflow = "hidden";
            });
          },
          close() {
            this.isOpen = false;
            this.$nextTick(() => {
              document.documentElement.style.overflow = "";
            });
          },
          submit() {
            if (!this.form.name || !this.form.email) return;
            this.contacts.push({ ...this.form });
            this.form = {
              name: "",
              email: "",
              role: "user",
            };
            this.close();
          },
          init() {
            this.$watch("form", () => {
              // console.log(this.form);
            });
            this.$watch("contacts", () => {
              console.log(this.contacts);
            });
          },
        };
      }
    </script>
    <script src="/js/load.js"></script>
  </body>
</html>
